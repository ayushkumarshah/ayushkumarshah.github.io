

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>Organize pandas notebook with cool hacks - Ayush Kumar Shah</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Ayush Kumar Shah">
<meta property="og:title" content="Organize pandas notebook with cool hacks">


  <link rel="canonical" href="http://localhost:4001/2020/06/pandas-pipe-plotly/">
  <meta property="og:url" content="http://localhost:4001/2020/06/pandas-pipe-plotly/">



  <meta property="og:description" content="">



  <meta name="twitter:site" content="@ayushkumarshah7">
  <meta name="twitter:title" content="Organize pandas notebook with cool hacks">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="http://localhost:4001/2020/06/pandas-pipe-plotly/">

  
    <meta name="twitter:card" content="summary">
    
  

  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2020-06-06T11:00:00-04:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Ayush Kumar Shah",
      "url" : "http://localhost:4001",
      "sameAs" : ["https://twitter.com/ayushkumarshah7","https://github.com/ayushkumarshah","https://www.facebook.com/ayushkumarshah","https://www.linkedin.com/in/ayush7"]
    }
  </script>



  <meta name="google-site-verification" content="qgX-LJLtkvIk5WkHJP5FSa31RN98a1WhAjPK8w8JPxE" />




<!-- end SEO -->


<link href="http://localhost:4001/feed.xml" type="application/atom+xml" rel="alternate" title="Ayush Kumar Shah Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4001/assets/css/main.css">

<meta http-equiv="cleartype" content="on">
    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4001/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4001/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4001/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4001/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4001/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4001/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4001/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4001/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4001/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4001/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="http://localhost:4001/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="http://localhost:4001/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="http://localhost:4001/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="http://localhost:4001/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="http://localhost:4001/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4001/">Ayush Kumar Shah</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/research/">Research</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/cv/">CV</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/projects/">Projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/teaching/">Teaching</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/year-archive/">Blog Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/certificates/">Certificates</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4001/images/profile.jpeg" class="author__avatar" alt="Ayush Kumar Shah">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Ayush Kumar Shah</h3>
    <p class="author__bio">Computer Science Ph.D. Student</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Rochester, New York</li>
      
      
      
      
        <li><a href="mailto:ayush.kumar.shah@gmail.com"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
      
      
       
      
        <li><a href="https://twitter.com/ayushkumarshah7"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
      
      
      
      
        <li><a href="https://www.linkedin.com/in/ayush7"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="https://github.com/ayushkumarshah"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.com/citations?hl=en&authuser=1&user=SD3Nv10AAAAJ"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
        <li><a href="http://orcid.org/0000-0001-6158-7632"><i class="ai ai-orcid-square ai-fw"></i> ORCID</a></li>
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Organize pandas notebook with cool hacks">
    <!-- <meta itemprop="description" content="Learn a cool hack to make pandas code clean, well-organized, and highly efficient."> -->
    <meta itemprop="description" content="">
    <meta itemprop="datePublished" content="June 06, 2020">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Organize pandas notebook with cool hacks
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  36 minute read
	
</p>
          
        

        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2020-06-06T11:00:00-04:00">June 06, 2020</time></p>
        

        
        
        
        
        
        

        </header>
      

      <section class="page__content" itemprop="text">
        <p><img src="/assets/img/sample/messy_nb.png" alt="messy-notebook" /></p>

<p>Does it ring a bell looking at this messy notebook? I am sure you must have created or encountered a similar kind of notebook while performing data analysis tasks in pandas.</p>

<p>Pandas is widely used by data scientists and ML Engineers all around the world to perform all kinds of data related tasks like data cleaning and preprocessing, data analysis, data manipulation, data conversion, etc. However, most of us are not using it right, as seen in the above example, which has decreased our productivity a lot.</p>

<p>You might wonder then what is the correct way to use pandas. Is there any particular way that we can make the notebook clean and modular so that we can increase our productivity?</p>

<p>Luckily, there is a type of quick hack or technique, whatever you may call it, which can be used to greatly improve the workflow and make notebooks not only clean and well organized but highly productive and efficient. The good thing is that you don’t need to install any extra packages or libraries. In the end, your notebook will look something like this.</p>

<p><img src="/assets/img/sample/clean_nb.png" alt="Clean notebook" /></p>

<blockquote>
  <p>Note: Dark mode is available on this website. You can switch between the modes by clicking the leftmost button at the bottom of the left sidebar.</p>
</blockquote>

<p><img src="/assets/img/sample/dark_mode.png" alt="dark_mode" /></p>

<h1 id="untitled12ipynb">Untitled12.ipynb</h1>

<p>The way to achieve clean and well-organized pandas notebooks was explored in the presentation <a href="https://pydata.org/eindhoven2019/schedule/presentation/19/untitled12ipynb/">Untitled12.ipynb</a> by <a href="https://twitter.com/fishnets88?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">Vincent D. Warmerdam</a> at <a href="https://pydata.org/eindhoven2019/">PyData Eindhoven 2019</a></p>

<p>The presentation <a href="https://www.youtube.com/watch?v=MpFZUshKypk&amp;t=1292s">Untitled12.ipynb: Prevent Miles of Scrolling, Reduce the Spaghetti Code from the Copy Pasta</a> has been uploaded in youtube as well. You can watch the video below if you want:</p>

<div class="video-holder" style="padding-bottom: 56.25%">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/MpFZUshKypk" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<p><br /></p>

<p>In this article, I will briefly summarize the presentation by <a href="https://twitter.com/fishnets88?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor">Vincent D. Warmerdam</a> and then move on to the code implementation (solution) and a few code examples based on the methods used in his presentation.</p>

<p><strong>The Untitled phenomena</strong></p>

<p><img src="/assets/img/sample/Untitled12.png" alt="Untitled12.ipynb" /></p>

<p>He began his talk by introducing a term called <strong><code class="language-plaintext highlighter-rouge">Untitled phenomena</code></strong>. The term simply refers to the bad practice of not naming the notebook files which eventually creates an unorganized bunch of Untitled notebooks. As a result, he also named the presentation <strong><code class="language-plaintext highlighter-rouge">Untitled12.ipynb</code></strong>.</p>

<p>Moreover, not only the bad practice of naming that we follow but also the bad organization of code inside the notebook needs to be improved. Copying and pasting code multiple times creates spaghetti code. This is especially true for a lot of data science based Jupyter notebooks. The goal of his talk was to uncover a great pattern for pandas that would prevent loads of scrolling such that the code behaves like lego. He also gave some useful tricks and tips on how to prevent miles of scrolling and reduce the spaghetti code when creating Jupyter notebooks.</p>

<h2 id="-skip-to-coding-solution">&gt; <a href="#solution"><strong>Skip to coding solution</strong></a></h2>

<p>I have initially written a summary of the talk Untitled12.ipynb and explored some common problems in the usual coding style before moving to the solution. If you want to directly jump to the coding solution to create a clean pandas notebook using a pipeline, then click the link above. However, I recommend you to read the common problems I have mentioned before going to the solution.</p>

<h1 id="contents">Contents</h1>

<p>I will be talking about the following topics which will more or less revolve around his talk.</p>

<ul>
  <li><a href="#importance">Importance of Workflow</a></li>
  <li><a href="#current">The Usual coding style</a></li>
  <li><a href="#problems">Problems in the usual coding style</a></li>
  <li><a href="#solution">Coding Solution</a></li>
  <li><a href="#advantages">Advantages</a></li>
</ul>

<p><a name="importance"></a></p>

<h2 id="importance-of-workflow">Importance of Workflow</h2>

<p>At the beginning of the presentation, he began by discussing the following points that highlight the importance of workflows and the need of jupyter-notebook and pandas over excel:</p>

<ul>
  <li>
    <p>We want to separate the data from the analysis: Tha analysis portion should not modify the raw data. The raw data should be safe from these modifications so that it can be reused later as well. However, this is not possible in excel.</p>
  </li>
  <li>
    <p>We want to be able to automate our analysis. The main aim of programming and workflow is automation. Our tasks become a lot easier if we can automate the analysis using a pandas script rather than performing the analysis every time using Excel.</p>
  </li>
  <li>
    <p>We want our analysis to be reproducible i.e. we must be able to reproduce the same analysis results on the data at a later time in the future.</p>
  </li>
  <li>
    <p>We should not pay a third part obscene amounts of money for something as basic as arithmetic. This budget is better allocated towards innovation and education of staff.</p>
  </li>
</ul>

<p>However, the current style of coding in pandas and jupyter notebook has solved only the last point.</p>

<p><a name="current"></a></p>

<h2 id="the-usual-coding-style">The usual coding style</h2>

<p>Let’s explore the common practice of writing pandas code and try to point out the major problems in such approaches.</p>

<p>Initially, I will show the general workflow that most of us follow while using pandas. I will be performing some analysis on the real COVID 19 dataset of the U.S. states obtained from
<a href="https://covidtracking.com/">The COVID Tracking Project</a> which is available under the <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons CC BY-NC-4.0 license</a>. The dataset is updated each day between 4 pm and 5 pm EDT.</p>

<p>After showing the common approach, I will point out the major pitfalls and then move on to the solution.</p>

<p>First, I will download the U.S. COVID-19 dataset using the API provided by <a href="https://covidtracking.com/">The COVID Tracking Project</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">mkdir</span> <span class="n">data</span>
<span class="err">!</span><span class="n">wget</span> <span class="o">-</span><span class="n">O</span> <span class="n">data</span><span class="o">/</span><span class="n">covid19_us_states_daily</span><span class="p">.</span><span class="n">csv</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">covidtracking</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">states</span><span class="o">/</span><span class="n">daily</span><span class="p">.</span><span class="n">csv</span>
<span class="err">!</span><span class="n">wget</span>  <span class="o">-</span><span class="n">O</span> <span class="n">data</span><span class="o">/</span><span class="n">state_info</span><span class="p">.</span><span class="n">csv</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">covidtracking</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">v1</span><span class="o">/</span><span class="n">states</span><span class="o">/</span><span class="n">info</span><span class="p">.</span><span class="n">csv</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--2020-06-05 16:34:10--  https://covidtracking.com/api/v1/states/daily.csv
Resolving covidtracking.com (covidtracking.com)... 104.248.63.231, 2604:a880:400:d1::888:7001
Connecting to covidtracking.com (covidtracking.com)|104.248.63.231|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/csv]
Saving to: ‘data/covid19_us_states_daily.csv’

data/covid19_us_sta     [  &lt;=&gt;               ] 987.40K  3.11MB/s    in 0.3s    

2020-06-05 16:34:11 (3.11 MB/s) - ‘data/covid19_us_states_daily.csv’ saved [1011093]

--2020-06-05 16:34:12--  https://covidtracking.com/api/v1/states/info.csv
Resolving covidtracking.com (covidtracking.com)... 104.248.50.87, 2604:a880:400:d1::888:7001
Connecting to covidtracking.com (covidtracking.com)|104.248.50.87|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/csv]
Saving to: ‘data/state_info.csv’

data/state_info.csv     [ &lt;=&gt;                ]  27.67K  --.-KB/s    in 0.02s   

2020-06-05 16:34:13 (1.43 MB/s) - ‘data/state_info.csv’ saved [28329]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span> 
<span class="c1"># Importing plotly library for plotting interactive graphs
</span><span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="n">go</span>
<span class="kn">from</span> <span class="nn">plotly.subplots</span> <span class="kn">import</span> <span class="n">make_subplots</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="n">px</span>
<span class="kn">import</span> <span class="nn">chart_studio</span>
<span class="kn">import</span> <span class="nn">chart_studio.plotly</span> <span class="k">as</span> <span class="n">py</span>
</code></pre></div></div>

<p>The first step is generally to read or import the data</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/covid19_us_states_daily.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'date'</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>hospitalizedCurrently</th>
      <th>hospitalizedCumulative</th>
      <th>inIcuCurrently</th>
      <th>inIcuCumulative</th>
      <th>onVentilatorCurrently</th>
      <th>onVentilatorCumulative</th>
      <th>recovered</th>
      <th>dataQualityGrade</th>
      <th>lastUpdateEt</th>
      <th>dateModified</th>
      <th>checkTimeEt</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>fips</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>posNeg</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20200604</th>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>376.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>2</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>60097</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1929.0</td>
      <td>NaN</td>
      <td>601.0</td>
      <td>NaN</td>
      <td>357.0</td>
      <td>11395.0</td>
      <td>B</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>1</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>235299</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>NaN</td>
      <td>138.0</td>
      <td>757.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>127.0</td>
      <td>5717.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>142480</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C</td>
      <td>6/1/2020 00:00</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>05/31 20:00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>NaN</td>
      <td>1079.0</td>
      <td>3195.0</td>
      <td>375.0</td>
      <td>NaN</td>
      <td>223.0</td>
      <td>NaN</td>
      <td>5172.0</td>
      <td>A+</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>4</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>249755</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>After taking a glance at the data, I realize that the date is not formatted well, so I format it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"%Y%m%d"</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>hospitalizedCurrently</th>
      <th>hospitalizedCumulative</th>
      <th>inIcuCurrently</th>
      <th>inIcuCumulative</th>
      <th>onVentilatorCurrently</th>
      <th>onVentilatorCumulative</th>
      <th>recovered</th>
      <th>dataQualityGrade</th>
      <th>lastUpdateEt</th>
      <th>dateModified</th>
      <th>checkTimeEt</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>fips</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>posNeg</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-06-04</th>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>376.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>2</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>60097</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1929.0</td>
      <td>NaN</td>
      <td>601.0</td>
      <td>NaN</td>
      <td>357.0</td>
      <td>11395.0</td>
      <td>B</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>1</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>235299</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>NaN</td>
      <td>138.0</td>
      <td>757.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>127.0</td>
      <td>5717.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>142480</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C</td>
      <td>6/1/2020 00:00</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>05/31 20:00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>NaN</td>
      <td>1079.0</td>
      <td>3195.0</td>
      <td>375.0</td>
      <td>NaN</td>
      <td>223.0</td>
      <td>NaN</td>
      <td>5172.0</td>
      <td>A+</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>4</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>249755</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<p>Then, I try to view some additional information about the dataset</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
DatetimeIndex: 5113 entries, 2020-06-04 to 2020-01-22
Data columns (total 34 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   state                     5113 non-null   object 
 1   positive                  5098 non-null   float64
 2   negative                  4902 non-null   float64
 3   pending                   842 non-null    float64
 4   hospitalizedCurrently     2591 non-null   float64
 5   hospitalizedCumulative    2318 non-null   float64
 6   inIcuCurrently            1362 non-null   float64
 7   inIcuCumulative           576 non-null    float64
 8   onVentilatorCurrently     1157 non-null   float64
 9   onVentilatorCumulative    198 non-null    float64
 10  recovered                 2409 non-null   float64
 11  dataQualityGrade          4012 non-null   object 
 12  lastUpdateEt              4758 non-null   object 
 13  dateModified              4758 non-null   object 
 14  checkTimeEt               4758 non-null   object 
 15  death                     4388 non-null   float64
 16  hospitalized              2318 non-null   float64
 17  dateChecked               4758 non-null   object 
 18  fips                      5113 non-null   int64  
 19  positiveIncrease          5113 non-null   int64  
 20  negativeIncrease          5113 non-null   int64  
 21  total                     5113 non-null   int64  
 22  totalTestResults          5113 non-null   int64  
 23  totalTestResultsIncrease  5113 non-null   int64  
 24  posNeg                    5113 non-null   int64  
 25  deathIncrease             5113 non-null   int64  
 26  hospitalizedIncrease      5113 non-null   int64  
 27  hash                      5113 non-null   object 
 28  commercialScore           5113 non-null   int64  
 29  negativeRegularScore      5113 non-null   int64  
 30  negativeScore             5113 non-null   int64  
 31  positiveScore             5113 non-null   int64  
 32  score                     5113 non-null   int64  
 33  grade                     0 non-null      float64
dtypes: float64(13), int64(14), object(7)
memory usage: 1.4+ MB
</code></pre></div></div>

<p>You can see that various columns are not of use. So, I decide to remove such columns.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="o">*</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="o">*</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">],</span> <span class="s">'posNeg'</span><span class="p">,</span> <span class="s">'fips'</span><span class="p">],</span> 
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
DatetimeIndex: 5113 entries, 2020-06-04 to 2020-01-22
Data columns (total 22 columns):
 #   Column                    Non-Null Count  Dtype  
---  ------                    --------------  -----  
 0   state                     5113 non-null   object 
 1   positive                  5098 non-null   float64
 2   negative                  4902 non-null   float64
 3   pending                   842 non-null    float64
 4   recovered                 2409 non-null   float64
 5   death                     4388 non-null   float64
 6   hospitalized              2318 non-null   float64
 7   dateChecked               4758 non-null   object 
 8   positiveIncrease          5113 non-null   int64  
 9   negativeIncrease          5113 non-null   int64  
 10  total                     5113 non-null   int64  
 11  totalTestResults          5113 non-null   int64  
 12  totalTestResultsIncrease  5113 non-null   int64  
 13  deathIncrease             5113 non-null   int64  
 14  hospitalizedIncrease      5113 non-null   int64  
 15  hash                      5113 non-null   object 
 16  commercialScore           5113 non-null   int64  
 17  negativeRegularScore      5113 non-null   int64  
 18  negativeScore             5113 non-null   int64  
 19  positiveScore             5113 non-null   int64  
 20  score                     5113 non-null   int64  
 21  grade                     0 non-null      float64
dtypes: float64(7), int64(12), object(3)
memory usage: 918.7+ KB
</code></pre></div></div>

<p>I also realize that there are a lot of missing (nan or null) values. So, I replace the missing values by 0.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>recovered</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-06-04</th>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>0.0</td>
      <td>376.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>0.0</td>
      <td>11395.0</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>0.0</td>
      <td>5717.0</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>0.0</td>
      <td>5172.0</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<p>I also want to add a column corresponding to the state name instead of the abbreviation. So, I merge state_info with the current dataframe.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/state_info.csv'</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s">'state'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">])</span>
<span class="n">df3</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span>
      <span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
      <span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'state'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">df3</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>recovered</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-06-04</td>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>0.0</td>
      <td>376.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Alaska</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-06-04</td>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>0.0</td>
      <td>11395.0</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-06-04</td>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>0.0</td>
      <td>5717.0</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Arkansas</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-06-04</td>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>American Samoa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-06-04</td>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>0.0</td>
      <td>5172.0</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Arizona</td>
    </tr>
  </tbody>
</table>
</div>

<p>I realize that the date index is lost. So, I reset the date index. Also, it is better to rename the column name as state_name.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df3</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'date'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df3</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'state_name'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df3</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>recovered</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
      <th>state_name</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-06-04</th>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>0.0</td>
      <td>376.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Alaska</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>0.0</td>
      <td>11395.0</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>0.0</td>
      <td>5717.0</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Arkansas</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>American Samoa</td>
    </tr>
    <tr>
      <th>2020-06-04</th>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>0.0</td>
      <td>5172.0</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
      <td>Arizona</td>
    </tr>
  </tbody>
</table>
</div>

<p>Now that the data is ready for some analysis, I decide to plot deaths count in each state indexed by date using the interactive <a href="https://plotly.com/">plotly library</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">line</span><span class="p">(</span><span class="n">df3</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df3</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'death'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">'state'</span><span class="p">)</span>
<span class="n">fig1</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total deaths in each state (Cumulative)'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig1</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'daily_deaths'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/1/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/1.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<blockquote>
  <p>Note: These plots are interactive, so you can zoom in or out, pinch, hover over the graph, download it, and so on.</p>
</blockquote>

<p>Now, I decide to calculate the total deaths in the US across all states and plot it.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="p">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'D'</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">df4</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>recovered</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-22</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-25</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-26</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig2</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">line</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df4</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'death'</span><span class="p">)</span>
<span class="n">fig2</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total deaths in the U.S. (Cumulative)'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig2</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_daily_deaths'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/4/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/4.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<p>I also want to calculate the number of Active cases i.e.</p>
<blockquote>
  <p>Active = positive - deaths - recovered</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df4</span><span class="p">[</span><span class="s">'active'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df4</span><span class="p">[</span><span class="s">'positive'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df4</span><span class="p">[</span><span class="s">'death'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df4</span><span class="p">[</span><span class="s">'recovered'</span><span class="p">]</span>
</code></pre></div></div>

<p>Now, after calculating the active column, I want to plot active cases instead of death. So, I go to the previous cell and replace <code class="language-plaintext highlighter-rouge">death</code> by <code class="language-plaintext highlighter-rouge">active</code> and generate the plot.</p>

<p>In [25]: df4[’<del>death</del>’].plot()</p>

<p>In [25]: df4[‘active’].plot()</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig3</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">line</span><span class="p">(</span><span class="n">df4</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df4</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'active'</span><span class="p">)</span>
<span class="n">fig3</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total active cases in the U.S. (Cumulative)'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig3</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_daily_active'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/6/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/6.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<p>Then I decide to calculate the statistics of a single month of May only. Since the data is cumulative, I need to subtract the data of May from data of April to find the increase in various statistics in May after which I plot the results.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df5</span> <span class="o">=</span> <span class="p">(</span><span class="n">df3</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'2020-05'</span><span class="p">]</span>
          <span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'state_name'</span><span class="p">)</span>
          <span class="p">.</span><span class="n">agg</span><span class="p">({</span><span class="s">'positive'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'negative'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'pending'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'recovered'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'death'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'hospitalized'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
                <span class="s">'total'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
                <span class="s">'totalTestResults'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'deathIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
                <span class="s">'hospitalizedIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
                <span class="s">'negativeIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
                <span class="s">'positiveIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
                <span class="s">'totalTestResultsIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">}))</span>

<span class="n">df6</span> <span class="o">=</span> <span class="p">(</span><span class="n">df3</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="s">'2020-04'</span><span class="p">]</span>
          <span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'state_name'</span><span class="p">)</span>
          <span class="p">.</span><span class="n">agg</span><span class="p">({</span><span class="s">'positive'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'negative'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'pending'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'recovered'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'death'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'hospitalized'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
                <span class="s">'total'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
                <span class="s">'totalTestResults'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
                <span class="s">'deathIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
                <span class="s">'hospitalizedIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
                <span class="s">'negativeIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
                <span class="s">'positiveIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
                <span class="s">'totalTestResultsIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">}))</span>

<span class="n">df7</span> <span class="o">=</span> <span class="n">df5</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df6</span><span class="p">)</span>
<span class="n">df7</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>recovered</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>negativeIncrease</th>
      <th>positiveIncrease</th>
      <th>totalTestResultsIncrease</th>
    </tr>
    <tr>
      <th>state_name</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alabama</th>
      <td>10884.0</td>
      <td>119473.0</td>
      <td>0.0</td>
      <td>9355.0</td>
      <td>362.0</td>
      <td>866.0</td>
      <td>130357</td>
      <td>130357</td>
      <td>106</td>
      <td>-112</td>
      <td>45594</td>
      <td>4846</td>
      <td>50440</td>
    </tr>
    <tr>
      <th>Alaska</th>
      <td>79.0</td>
      <td>32497.0</td>
      <td>0.0</td>
      <td>116.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>32576</td>
      <td>32576</td>
      <td>-5</td>
      <td>7</td>
      <td>17327</td>
      <td>-157</td>
      <td>17170</td>
    </tr>
    <tr>
      <th>American Samoa</th>
      <td>0.0</td>
      <td>171.0</td>
      <td>-17.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>154</td>
      <td>171</td>
      <td>0</td>
      <td>0</td>
      <td>171</td>
      <td>0</td>
      <td>171</td>
    </tr>
    <tr>
      <th>Arizona</th>
      <td>12288.0</td>
      <td>141132.0</td>
      <td>0.0</td>
      <td>3262.0</td>
      <td>586.0</td>
      <td>1829.0</td>
      <td>153420</td>
      <td>153420</td>
      <td>290</td>
      <td>660</td>
      <td>95076</td>
      <td>5929</td>
      <td>101005</td>
    </tr>
    <tr>
      <th>Arkansas</th>
      <td>3998.0</td>
      <td>77138.0</td>
      <td>0.0</td>
      <td>3970.0</td>
      <td>72.0</td>
      <td>309.0</td>
      <td>81136</td>
      <td>81136</td>
      <td>19</td>
      <td>-93</td>
      <td>37973</td>
      <td>1266</td>
      <td>39239</td>
    </tr>
  </tbody>
</table>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig4</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df7</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df7</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'death'</span><span class="p">)</span>
<span class="n">fig4</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'state_name'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total Deaths in th US in May only'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig4</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_deaths_May'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/12/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/12.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<p><a name="problems"></a></p>

<h2 id="problems-in-the-usual-coding-style">Problems in the usual coding style</h2>

<p>Now that I have demonstrated the usual approach followed in pandas notebook, let’s discuss the problems in this approach.</p>

<h3 id="1-flow-is-disrupted">1. Flow is disrupted:</h3>

<p>The flow of the notebook is very difficult to understand and also creates problems. For example, we may create a variable name under the plot that needs it. In the above code as well, we created <strong><code class="language-plaintext highlighter-rouge">df3['active']</code></strong> below the cell in which it is needed. So, it may cause errors when run by others. Also, you may have to scroll the notebook for miles and miles.</p>

<h3 id="2-no-reproducibility">2. No reproducibility:</h3>

<p>When the notebook is shared with others, the other person faces a lot of problems to execute or understand the notebook. For instance, the name of the dataframes doesn’t signify any information about the type of dataframe. It runs from <strong><code class="language-plaintext highlighter-rouge">df1</code></strong> to <strong><code class="language-plaintext highlighter-rouge">df7</code></strong> and creates a lot of confusion. But you want to create a notebook which is very easy to iterate on and the one you can share with your colleagues.</p>

<h3 id="3-difficult-to-move-the-code-to-production">3. Difficult to move the code to production:</h3>

<p>With this approach, your code is not ready to move into production. You end up having to rewrite the whole notebook before moving it to production which is not effective.</p>

<h3 id="4-unable-to-automate">4. Unable to automate:</h3>

<p>The notebook in the current condition cannot be automated for analysis since there may occur a lot of problems like an error in code execution, unavailability of filenames used.</p>

<p>Although the code may give an interesting conclusion or desired output, we are not quite sure that conclusion is at least correct.</p>

<p>Despite having so many problems associated with this approach, it is common for everyone to still use this type of flow while making a notebook since while coding, people enjoy when the code works when they check the outputs and hence keep on similarly continuing the coding.</p>

<p><a name="solution"></a></p>

<h2 id="coding-solution">Coding Solution</h2>

<h3 id="1-naming-convention">1. Naming convention</h3>

<p>Follow a naming convention for the notebook according to the task as suggested by <a href="https://drivendata.github.io/cookiecutter-data-science/#notebooks-are-for-exploration-and-communication">Cookiecutter Data Science</a> that shows the owner and the order the analysis was done in. You can use the format</p>

<p><strong><code class="language-plaintext highlighter-rouge">&lt;step&gt;-&lt;ghuser&gt;-&lt;description&gt;.ipynb</code></strong></p>

<p>(e.g., <strong><code class="language-plaintext highlighter-rouge">0.1-ayush-visualize-corona-us.ipynb</code></strong>).</p>

<h3 id="2-plan-your-steps-beforehand">2. Plan your steps beforehand</h3>

<p>Load the data and then think in advance about all the steps of analysis or tasks you could be doing in the notebook. You don’t need to think the logic right away but just keep in mind the steps.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/covid19_us_states_daily.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s">'date'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="3-create-functions">3. Create functions</h3>

<p>You know that initially, you want to clean the data and make sure the columns and indexes are in a proper usable format. So, why not create a function for that and name it according to the subtasks on the dataframe.</p>

<blockquote>
  <p>For example, initially you want to make the index a proper datetime object. Then you may want to do remove the duplicates, then add state name. Just add these functions without even thinking the logic and then later you can add the logic. This way, you will be on track and not lost.</p>
</blockquote>

<p>The functions are created after creating the decorator.</p>

<h3 id="4-create-proper-decorators">4. Create proper decorators</h3>

<p>Before adding functions, let’s also think about some additional utility that would be helpful. During the pandas analysis, you often check the shape, columns, and other information associated to the dataframe after performing an operation. However, a decorator can help automate this process.</p>

<p><strong><code class="language-plaintext highlighter-rouge">Decorator</code></strong> is simply a function that expects a function and returns a function. It’s really functional right, haha. Don’t get confused by the definition. It is not so difficult as it sounds. We will see how it works in the code below.</p>

<p>Also, if you are not familiar with decorators or want to learn more about it, you can visit the <a href="https://realpython.com/primer-on-python-decorators/#simple-decorators">article by Geir Arne Hjelle</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="n">dt</span>
<span class="k">def</span> <span class="nf">df_info</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">tic</span> <span class="o">=</span> <span class="n">dt</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">toc</span> <span class="o">=</span> <span class="n">dt</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n\n</span><span class="s">{} took {} time</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">toc</span> <span class="o">-</span> <span class="n">tic</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"After applying {}</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">__name__</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Shape of df = {}</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Columns of df are {}</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">columns</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Index of df is {}</span><span class="se">\n</span><span class="s">"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="n">index</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="s">"-"</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">''</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</code></pre></div></div>

<p>We have created a decorator called <strong><code class="language-plaintext highlighter-rouge">df_info</code></strong> which displays information like time taken by the function, shape, and columns after applying any function <strong><code class="language-plaintext highlighter-rouge">f</code></strong>.</p>

<p>The advantage of using a deorator is that we get logging. You can modify the decorator according to the information that you want to log or display after performing an operation on the dataframe.</p>

<p>Now, we create functions as our plan and use these decorators on them by using <strong><code class="language-plaintext highlighter-rouge">@df_info</code></strong>. This will be equivalent to calling <strong><code class="language-plaintext highlighter-rouge">df_info(f(df, *args, **kwargs))</code></strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">create_dateindex</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s">"%Y%m%d"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">remove_columns</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="o">*</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="o">*</span><span class="n">df</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">:</span><span class="mi">15</span><span class="p">],</span> <span class="s">'posNeg'</span><span class="p">,</span> <span class="s">'fips'</span><span class="p">],</span> 
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">fill_missing</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">add_state_name</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'data/state_info.csv'</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s">'state'</span><span class="p">,</span> <span class="s">'name'</span><span class="p">])</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span>
      <span class="p">.</span><span class="n">reset_index</span><span class="p">()</span>
      <span class="p">.</span><span class="n">merge</span><span class="p">(</span><span class="n">_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">'state'</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s">'left'</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
    <span class="n">df</span><span class="p">.</span><span class="n">set_index</span><span class="p">(</span><span class="s">'date'</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">df</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span> <span class="s">'state_name'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">drop_state</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'state'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">sample_daily</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'D'</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">add_active_cases</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="s">'active'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s">'positive'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s">'death'</span><span class="p">]</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="s">'recovered'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="k">def</span> <span class="nf">aggregate_monthly</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">month</span><span class="p">]</span>
        <span class="p">.</span><span class="n">groupby</span><span class="p">(</span><span class="s">'state_name'</span><span class="p">)</span>
        <span class="p">.</span><span class="n">agg</span><span class="p">({</span><span class="s">'positive'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'negative'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'pending'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'recovered'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'death'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'hospitalized'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
            <span class="s">'total'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span> 
            <span class="s">'totalTestResults'</span><span class="p">:</span> <span class="s">'first'</span><span class="p">,</span>
            <span class="s">'deathIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
            <span class="s">'hospitalizedIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
            <span class="s">'negativeIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span> 
            <span class="s">'positiveIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">,</span>
            <span class="s">'totalTestResultsIncrease'</span><span class="p">:</span> <span class="s">'sum'</span><span class="p">}))</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="o">@</span><span class="n">df_info</span>
<span class="k">def</span> <span class="nf">create_month_only</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">month</span><span class="p">):</span>
    <span class="n">df_current</span> <span class="o">=</span> <span class="n">aggregate_monthly</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">month</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">prev_month</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s">'-12'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prev_month</span> <span class="o">=</span> <span class="n">month</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="s">'{:02d}'</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">month</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">df_previous</span> <span class="o">=</span> <span class="n">aggregate_monthly</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">prev_month</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df_current</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">df_previous</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

    
</code></pre></div></div>

<h3 id="5-remove-side-effect">5. Remove side effect</h3>

<p>However, these functions make changes that are inplace (side effects) i.e. modifies the originally loaded dataframe. So, to solve this, we add a function called start pipeline, which returns a copy of dataframe.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">start_pipeline</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="n">copy</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="6-constructing-pandas-pipelines-main-step">6. Constructing pandas pipelines (Main step)</h3>

<p>Now, let’s use these functions to achieve the previous tasks using <strong><code class="language-plaintext highlighter-rouge">pipe</code></strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_daily</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">start_pipeline</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">create_dateindex</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">remove_columns</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">fill_missing</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_state_name</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">sample_daily</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_active_cases</span><span class="p">))</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create_dateindex took 0:00:00.003388 time

After applying create_dateindex

Shape of df = (5113, 34)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'hospitalizedCurrently',
       'hospitalizedCumulative', 'inIcuCurrently', 'inIcuCumulative',
       'onVentilatorCurrently', 'onVentilatorCumulative', 'recovered',
       'dataQualityGrade', 'lastUpdateEt', 'dateModified', 'checkTimeEt',
       'death', 'hospitalized', 'dateChecked', 'fips', 'positiveIncrease',
       'negativeIncrease', 'total', 'totalTestResults',
       'totalTestResultsIncrease', 'posNeg', 'deathIncrease',
       'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

remove_columns took 0:00:00.002087 time

After applying remove_columns

Shape of df = (5113, 22)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

fill_missing took 0:00:00.006381 time

After applying fill_missing

Shape of df = (5113, 22)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

add_state_name took 0:00:00.015122 time

After applying add_state_name

Shape of df = (5113, 23)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade', 'state_name'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

sample_daily took 0:00:00.017170 time

After applying sample_daily

Shape of df = (135, 19)

Columns of df are Index(['positive', 'negative', 'pending', 'recovered', 'death', 'hospitalized',
       'positiveIncrease', 'negativeIncrease', 'total', 'totalTestResults',
       'totalTestResultsIncrease', 'deathIncrease', 'hospitalizedIncrease',
       'commercialScore', 'negativeRegularScore', 'negativeScore',
       'positiveScore', 'score', 'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-01-22', '2020-01-23', '2020-01-24', '2020-01-25',
               '2020-01-26', '2020-01-27', '2020-01-28', '2020-01-29',
               '2020-01-30', '2020-01-31',
               ...
               '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29',
               '2020-05-30', '2020-05-31', '2020-06-01', '2020-06-02',
               '2020-06-03', '2020-06-04'],
              dtype='datetime64[ns]', name='date', length=135, freq='D')

----------------------------------------------------------------------------------------------------

add_active_cases took 0:00:00.002020 time

After applying add_active_cases

Shape of df = (135, 20)

Columns of df are Index(['positive', 'negative', 'pending', 'recovered', 'death', 'hospitalized',
       'positiveIncrease', 'negativeIncrease', 'total', 'totalTestResults',
       'totalTestResultsIncrease', 'deathIncrease', 'hospitalizedIncrease',
       'commercialScore', 'negativeRegularScore', 'negativeScore',
       'positiveScore', 'score', 'grade', 'active'],
      dtype='object')

Index of df is DatetimeIndex(['2020-01-22', '2020-01-23', '2020-01-24', '2020-01-25',
               '2020-01-26', '2020-01-27', '2020-01-28', '2020-01-29',
               '2020-01-30', '2020-01-31',
               ...
               '2020-05-26', '2020-05-27', '2020-05-28', '2020-05-29',
               '2020-05-30', '2020-05-31', '2020-06-01', '2020-06-02',
               '2020-06-03', '2020-06-04'],
              dtype='datetime64[ns]', name='date', length=135, freq='D')
</code></pre></div></div>

<p>Check out all the logs displayed above. We are able to view in detail how each operation changed the data without having to print the dataframe after each operation.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig2</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">line</span><span class="p">(</span><span class="n">df_daily</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df_daily</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'death'</span><span class="p">)</span>
<span class="n">fig2</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total deaths in the U.S. (Cumulative)'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig2</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_daily_deaths'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/4/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/4.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig3</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">line</span><span class="p">(</span><span class="n">df_daily</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df_daily</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'active'</span><span class="p">)</span>
<span class="n">fig3</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'date'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total active cases in the U.S. (Cumulative)'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig3</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_daily_active'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/6/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/6.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_may</span> <span class="o">=</span> <span class="n">create_month_only</span><span class="p">(</span>
                <span class="n">df</span><span class="o">=</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">start_pipeline</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">create_dateindex</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">remove_columns</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">fill_missing</span><span class="p">)</span>
                    <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_state_name</span><span class="p">)),</span> 
                <span class="n">month</span><span class="o">=</span><span class="s">'2020-05'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>create_dateindex took 0:00:00.002492 time

After applying create_dateindex

Shape of df = (5113, 34)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'hospitalizedCurrently',
       'hospitalizedCumulative', 'inIcuCurrently', 'inIcuCumulative',
       'onVentilatorCurrently', 'onVentilatorCumulative', 'recovered',
       'dataQualityGrade', 'lastUpdateEt', 'dateModified', 'checkTimeEt',
       'death', 'hospitalized', 'dateChecked', 'fips', 'positiveIncrease',
       'negativeIncrease', 'total', 'totalTestResults',
       'totalTestResultsIncrease', 'posNeg', 'deathIncrease',
       'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

remove_columns took 0:00:00.002219 time

After applying remove_columns

Shape of df = (5113, 22)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

fill_missing took 0:00:00.001883 time

After applying fill_missing

Shape of df = (5113, 22)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

add_state_name took 0:00:00.014981 time

After applying add_state_name

Shape of df = (5113, 23)

Columns of df are Index(['state', 'positive', 'negative', 'pending', 'recovered', 'death',
       'hospitalized', 'dateChecked', 'positiveIncrease', 'negativeIncrease',
       'total', 'totalTestResults', 'totalTestResultsIncrease',
       'deathIncrease', 'hospitalizedIncrease', 'hash', 'commercialScore',
       'negativeRegularScore', 'negativeScore', 'positiveScore', 'score',
       'grade', 'state_name'],
      dtype='object')

Index of df is DatetimeIndex(['2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04', '2020-06-04', '2020-06-04',
               '2020-06-04', '2020-06-04',
               ...
               '2020-01-31', '2020-01-30', '2020-01-29', '2020-01-28',
               '2020-01-27', '2020-01-26', '2020-01-25', '2020-01-24',
               '2020-01-23', '2020-01-22'],
              dtype='datetime64[ns]', name='date', length=5113, freq=None)

----------------------------------------------------------------------------------------------------

create_month_only took 0:00:00.031071 time

After applying create_month_only

Shape of df = (56, 13)

Columns of df are Index(['positive', 'negative', 'pending', 'recovered', 'death', 'hospitalized',
       'total', 'totalTestResults', 'deathIncrease', 'hospitalizedIncrease',
       'negativeIncrease', 'positiveIncrease', 'totalTestResultsIncrease'],
      dtype='object')

Index of df is Index(['Alabama', 'Alaska', 'American Samoa', 'Arizona', 'Arkansas',
       'California', 'Colorado', 'Connecticut', 'Delaware',
       'District Of Columbia', 'Florida', 'Georgia', 'Guam', 'Hawaii', 'Idaho',
       'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana',
       'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota',
       'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada',
       'New Hampshire', 'New Jersey', 'New Mexico', 'New York',
       'North Carolina', 'North Dakota', 'Northern Mariana Islands', 'Ohio',
       'Oklahoma', 'Oregon', 'Pennsylvania', 'Puerto Rico', 'Rhode Island',
       'South Carolina', 'South Dakota', 'Tennessee', 'Texas',
       'US Virgin Islands', 'Utah', 'Vermont', 'Virginia', 'Washington',
       'West Virginia', 'Wisconsin', 'Wyoming'],
      dtype='object', name='state_name')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig4</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="n">bar</span><span class="p">(</span><span class="n">df_may</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">df_may</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s">'death'</span><span class="p">)</span>
<span class="n">fig4</span><span class="p">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s">'state_name'</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">'Total Deaths in th US in May only'</span><span class="p">)</span>
<span class="n">py</span><span class="p">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fig4</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="s">'total_deaths_May'</span><span class="p">,</span> <span class="n">auto_open</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'https://plotly.com/~ayush.kumar.shah/12/'
</code></pre></div></div>

<div class="video-holder" style="padding-bottom: 88.88888888888889%">
  <iframe width="900" height="800" src="//plotly.com/~ayush.kumar.shah/12.embed" frameborder="0" scrolling="no" allowfullscreen=""></iframe>
</div>

<p>You can observe how easily pipe functionality has achieved the required task in a clean and organized way. Also, the original dataframe is intact and not affected by the above operations.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>positive</th>
      <th>negative</th>
      <th>pending</th>
      <th>hospitalizedCurrently</th>
      <th>hospitalizedCumulative</th>
      <th>inIcuCurrently</th>
      <th>inIcuCumulative</th>
      <th>onVentilatorCurrently</th>
      <th>onVentilatorCumulative</th>
      <th>recovered</th>
      <th>dataQualityGrade</th>
      <th>lastUpdateEt</th>
      <th>dateModified</th>
      <th>checkTimeEt</th>
      <th>death</th>
      <th>hospitalized</th>
      <th>dateChecked</th>
      <th>fips</th>
      <th>positiveIncrease</th>
      <th>negativeIncrease</th>
      <th>total</th>
      <th>totalTestResults</th>
      <th>totalTestResultsIncrease</th>
      <th>posNeg</th>
      <th>deathIncrease</th>
      <th>hospitalizedIncrease</th>
      <th>hash</th>
      <th>commercialScore</th>
      <th>negativeRegularScore</th>
      <th>negativeScore</th>
      <th>positiveScore</th>
      <th>score</th>
      <th>grade</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>20200604</th>
      <td>AK</td>
      <td>513.0</td>
      <td>59584.0</td>
      <td>NaN</td>
      <td>13.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>376.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>2</td>
      <td>8</td>
      <td>1907</td>
      <td>60097</td>
      <td>60097</td>
      <td>1915</td>
      <td>60097</td>
      <td>0</td>
      <td>0</td>
      <td>c1046011af7271cbe2e6698526714c6cb5b92748</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AL</td>
      <td>19072.0</td>
      <td>216227.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1929.0</td>
      <td>NaN</td>
      <td>601.0</td>
      <td>NaN</td>
      <td>357.0</td>
      <td>11395.0</td>
      <td>B</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>653.0</td>
      <td>1929.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>1</td>
      <td>221</td>
      <td>3484</td>
      <td>235299</td>
      <td>235299</td>
      <td>3705</td>
      <td>235299</td>
      <td>0</td>
      <td>29</td>
      <td>bcbefdb36212ba2b97b5a354f4e45bf16648ee23</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AR</td>
      <td>8067.0</td>
      <td>134413.0</td>
      <td>NaN</td>
      <td>138.0</td>
      <td>757.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>127.0</td>
      <td>5717.0</td>
      <td>A</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>142.0</td>
      <td>757.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>142480</td>
      <td>142480</td>
      <td>0</td>
      <td>142480</td>
      <td>0</td>
      <td>26</td>
      <td>acd3a4fbbc3dbb32138725f91e3261d683e7052a</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AS</td>
      <td>0.0</td>
      <td>174.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>C</td>
      <td>6/1/2020 00:00</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>05/31 20:00</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2020-06-01T00:00:00Z</td>
      <td>60</td>
      <td>0</td>
      <td>0</td>
      <td>174</td>
      <td>174</td>
      <td>0</td>
      <td>174</td>
      <td>0</td>
      <td>0</td>
      <td>8bbc72fa42781e0549e2e4f9f4c3e7cbef14ab32</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>20200604</th>
      <td>AZ</td>
      <td>22753.0</td>
      <td>227002.0</td>
      <td>NaN</td>
      <td>1079.0</td>
      <td>3195.0</td>
      <td>375.0</td>
      <td>NaN</td>
      <td>223.0</td>
      <td>NaN</td>
      <td>5172.0</td>
      <td>A+</td>
      <td>6/4/2020 00:00</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>06/03 20:00</td>
      <td>996.0</td>
      <td>3195.0</td>
      <td>2020-06-04T00:00:00Z</td>
      <td>4</td>
      <td>520</td>
      <td>4710</td>
      <td>249755</td>
      <td>249755</td>
      <td>5230</td>
      <td>249755</td>
      <td>15</td>
      <td>66</td>
      <td>1fa237b8204cd23701577aef6338d339daa4452e</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="7-create-a-module">7. Create a module</h3>

<p>Finally, you can create a module (eg <code class="language-plaintext highlighter-rouge">processing.py</code>) and keep all the above functions in the module. You can simply import them here and use them directly. It will clean the notebook further.</p>

<p><strong><code class="language-plaintext highlighter-rouge">processing.py</code></strong></p>

<script src="https://gist.github.com/ayushkumarshah/aa35d7fbfb9474d2a615665766d20a35.js"></script>

<p>While loading the modules, load the “autoreload” extension so that you can change code in the modules and the changes get updated automatically. For more info, see <a href="https://ipython.org/ipython-doc/3/config/extensions/autoreload.html">autoreload documentation</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
<span class="kn">from</span> <span class="nn">processing</span> <span class="kn">import</span> <span class="o">*</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</code></pre></div></div>

<p><a name="advantages"></a></p>

<h2 id="advantages">Advantages</h2>

<h3 id="1-effective-for-the-long-run-maintainability">1. Effective for the long run (Maintainability)</h3>

<p>Although, the approach may look like an inefficient method of coding but it is very effective in the long run since you will not have to spend hours maintaining the notebook. Given the functions are well written and well defined, they are ready for production.</p>

<p>The code is easily sharable as well as anyone can understand the code unlike in the previous approach. Also, for complex analysis tasks, this approach can be easily used for maintaining the notebook.</p>

<h3 id="2-proper-flow-and-planning">2. Proper flow and planning</h3>

<p>You do not need to think about the logic of the analysis at the beginning. You can just plan your tasks and write down the required functions which already gives you kind of a framework of mind which helps to be on track. The calm that will follow is likely going to have a greater impact on innovation.</p>

<p>Then, you can finally define the logic at the end to make it work.</p>

<h3 id="3-easier-to-modify">3. Easier to modify</h3>

<p>You might have noticed that the <code class="language-plaintext highlighter-rouge">pipe</code> functionality gives you the ability to modify the tasks or flow easily. You can do so by commenting or adding the functions in the pipeline.</p>

<p>For example, you don’t want to remove the columns and sample the data daily. Then you can achieve this simply by commenting those lines as shown below:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_daily</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">start_pipeline</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">create_dateindex</span><span class="p">)</span>
            <span class="c1"># .pipe(remove_columns)
</span>            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">fill_missing</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_state_name</span><span class="p">)</span>
            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_state</span><span class="p">)</span>
            <span class="c1"># .pipe(sample_daily)
</span>            <span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">add_active_cases</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="4-easier-to-debug">4. Easier to debug</h3>

<p>In this approach, you know what is happening in each step which makes it a lot easier to debug. Furthermore, since all the operations are functions, you can easily debug the code by performing unit tests or using other methods on the functions.</p>

<h3 id="5-readability">5. Readability</h3>

<p>This approach helps you prevent miles of scrolling and also is easily readable than the previous approach. By looking at the code, you can easily understand what operations are being performed on the data and also can see the effect of those operations on the data in each step using decorator.</p>

<p>Example:</p>

<p>Let us consider cooking chicken. When we do so, we don’t describe the steps like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>temperature = 210 celsius
food1 = Chicken
food2 = Season(food1, with Spices)
food3 = Season(food2, with Gravy)
Serve(PutInOven(food3, temperature), on a plate)
</code></pre></div></div>

<p>But instead, we describe it the following way:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>temperature = 210 celsius
Chicken.Season(with Spices)
        .Season(with Gravy)
        .PutInOven(temperature)
        .Serve()
</code></pre></div></div>

<p>The pipe functionality helps us to write code in the latter way, which is also much more readable.</p>

<h3 id="6-reusability">6. Reusability</h3>

<p>During production, we turn the project into a Python package. You can import your code and use it in notebooks with a cell. You do not need to write code to do the same task in multiple notebooks.</p>

<h3 id="7-separation-into-analysis-and-data-manipulation">7. Separation into analysis and data manipulation</h3>

<p>Once your functions have been moved to a separate module, two levels of abstraction are obtained: analysis and data manipulation.</p>

<p>You can fiddle around on a high level and keep the details on a low level. The notebook
then becomes the summary and a user interface where you can very quickly make nice little charts instead of manipulating data or performing analytical steps to get a result.</p>

<h1 id="final-notes">Final notes</h1>

<p>Hence, following these practices while coding in pandas or performing other similar tasks like building scikit-learn pipelines or other ML pipelines, can be extremely beneficial for developers. Also, all the 4 problems mentioned in the beginning have been solved in this approach. Thus, giving utmost priority to clarity and interoperability, we should remember that it’s a lot easier to solve a problem if we understand the problem well.</p>

<p>Moreover, if you find writing these codes difficult, an open source package called <a href="https://scikit-lego.readthedocs.io/en/latest/pandas_pipeline.html#">Scikit-lego</a> maintained by Vincent and MatthijsB, with contributions from all around the world, is available.  This package does all the hard work for you to create such pipelines along with additional features like custom logging. Do check it out.</p>

<p>Also, if you have any confusion or suggestions, feel free to comment. I am all ears. Thank you.</p>

        
      </section>

      <footer class="page__meta">
        
        


  




  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4001/tags/#datascience" class="page__taxonomy-item" rel="tag">datascience</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4001/tags/#eda" class="page__taxonomy-item" rel="tag">EDA</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4001/tags/#pandas" class="page__taxonomy-item" rel="tag">pandas</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4001/tags/#pipeline" class="page__taxonomy-item" rel="tag">pipeline</a><span class="sep">, </span>
    
      
      
      <a href="http://localhost:4001/tags/#plotly" class="page__taxonomy-item" rel="tag">plotly</a>
    
    </span>
  </p>




  






  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4001/categories/#python-hacks" class="page__taxonomy-item" rel="tag">python-hacks</a>
    
    </span>
  </p>


      </footer>

      

<section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=http://localhost:4001/2020/06/pandas-pipe-plotly/" class="btn btn--twitter" title="Share on Twitter"><i class="fab fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4001/2020/06/pandas-pipe-plotly/" class="btn btn--facebook" title="Share on Facebook"><i class="fab fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4001/2020/06/pandas-pipe-plotly/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fab fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>

      


  <nav class="pagination">
    
      <a href="http://localhost:4001/2020/05/web-pelican-pt5-disqus-analytics/" class="pagination--pager" title="Part 5 - Integrate Disqus comments and Google Analytics with Pelican
">Previous</a>
    
    
      <a href="http://localhost:4001/2020/08/common-commands/" class="pagination--pager" title="Common commands
">Next</a>
    
  </nav>

    </div>

    
      

<div class="page__comments">
  
  
    <h4 class="page__comments-title">Leave a Comment</h4>
    <section id="disqus_thread"></section>
  
</div>
    
  </article>

  
  
    <div class="page__related">
      
        <h4 class="page__related-title">You May Also Enjoy</h4>
      
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4001/2020/08/common-commands/" rel="permalink">Common commands
</a>
      
    </h2>

    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  27 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2020-08-12T13:00:00-04:00">August 12, 2020</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><p>A curated list of common commands that makes usage easy.</p>
</p>
    

    
    
    
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4001/2020/05/web-pelican-pt5-disqus-analytics/" rel="permalink">Part 5 - Integrate Disqus comments and Google Analytics with Pelican
</a>
      
    </h2>

    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2020-05-11T00:45:00-04:00">May 11, 2020</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><p>Learn to link Disqus comments and Google Analytics to your site</p>
</p>
    

    
    
    
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4001/2020/05/web-pelican-pt4-travisci/" rel="permalink">Part 4 - Setting up Travis-CI for automating deployment
</a>
      
    </h2>

    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  4 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2020-05-10T21:47:00-04:00">May 10, 2020</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><p>Learn to use Travis-CI to automate deploying your website to master branch</p>
</p>
    

    
    
    
    
    
    

  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="http://schema.org/CreativeWork">
    

    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="http://localhost:4001/2020/03/web-pelican-pt3-hosting/" rel="permalink">Part 3 - Hosting your website to GitHub Pages and custom domain
</a>
      
    </h2>

    
      <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 


  
	  8 minute read
	
</p>
    

        
         <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Published:</strong> <time datetime="2020-03-28T22:30:00-04:00">March 28, 2020</time></p>
        

    
    <p class="archive__item-excerpt" itemprop="description"><p>Learn to host your website in GitHub pages or custom domain for free.</p>
</p>
    

    
    
    
    
    
    

  </article>
</div>

        
      </div>
    </div>
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/ayushkumarshah7"><i class="fab fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/ayushkumarshah"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4001/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Ayush Kumar Shah. </div>

      </footer>
    </div>

    <script src="http://localhost:4001/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'ayushkumarshah';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>

