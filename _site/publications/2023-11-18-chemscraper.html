

<!doctype html>
<html lang="en" class="no-js">
  <head>
    

<meta charset="utf-8">



<!-- begin SEO -->









<title>ChemScraper: Leveraging PDF Graphics Instructions for Molecular Diagram Parsing - Ayush Kumar Shah</title>







<meta property="og:locale" content="en-US">
<meta property="og:site_name" content="Ayush Kumar Shah">
<meta property="og:title" content="ChemScraper: Leveraging PDF Graphics Instructions for Molecular Diagram Parsing">


  <link rel="canonical" href="http://localhost:4001/publications/2023-11-18-chemscraper">
  <meta property="og:url" content="http://localhost:4001/publications/2023-11-18-chemscraper">



  <meta property="og:description" content="This paper is about a new parser for molecular diagrams.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2024-09-01T00:00:00-04:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Ayush Kumar Shah",
      "url" : "http://localhost:4001",
      "sameAs" : ["https://github.com/ayushkumarshah","https://www.facebook.com/ayushkumarshah","https://www.linkedin.com/in/ayush7"]
    }
  </script>



  <meta name="google-site-verification" content="qgX-LJLtkvIk5WkHJP5FSa31RN98a1WhAjPK8w8JPxE" />




<!-- end SEO -->


<link href="http://localhost:4001/feed.xml" type="application/atom+xml" rel="alternate" title="Ayush Kumar Shah Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<!--<link rel="stylesheet" href="http://localhost:4001/assets/css/main.css">-->
<link rel="stylesheet" href="http://localhost:4001/assets/css/main.css?v=1740016886">

<meta http-equiv="cleartype" content="on">

    

<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="http://localhost:4001/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="http://localhost:4001/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4001/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="http://localhost:4001/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4001/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="http://localhost:4001/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4001/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="http://localhost:4001/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:4001/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32">
<link rel="icon" type="image/png" href="http://localhost:4001/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96">
<link rel="icon" type="image/png" href="http://localhost:4001/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16">
<link rel="manifest" href="http://localhost:4001/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="http://localhost:4001/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="http://localhost:4001/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="http://localhost:4001/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="http://localhost:4001/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- end custom head snippets -->

  </head>

  <body>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <button><div class="navicon"></div></button>
        <ul class="visible-links">
          <li class="masthead__menu-item masthead__menu-item--lg"><a href="http://localhost:4001/">Ayush Kumar Shah</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/publications/">Publications</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/research/">Research</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/cv/">CV</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/projects/">Projects</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/teaching/">Teaching</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/year-archive/">Blog Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://localhost:4001/certificates/">Certificates</a></li>
          
        </ul>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    





<div id="main" role="main">
  


  <div class="sidebar sticky">
  



<div itemscope itemtype="http://schema.org/Person">

  <div class="author__avatar">
    
    	<img src="http://localhost:4001/images/profile.jpeg" class="author__avatar" alt="Ayush Kumar Shah">
    
  </div>

  <div class="author__content">
    <h3 class="author__name">Ayush Kumar Shah</h3>
    <p class="author__bio">Computer Science Ph.D. Student</p>
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> Rochester, New York</li>
      
      
      
      
        <li><a href="mailto:ayush.kumar.shah@gmail.com"><i class="fas fa-fw fa-envelope" aria-hidden="true"></i> Email</a></li>
      
      
       
      
      
      
      
        <li><a href="https://www.linkedin.com/in/ayush7"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
      
      
      
      
      
      
        <li><a href="https://gitlab.com/ayushkumarshah"><i class="fab fa-fw fa-gitlab" aria-hidden="true"></i> GitLab</a></li>
      
      
        <li><a href="https://github.com/ayushkumarshah"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
        <li><a href="https://scholar.google.com/citations?hl=en&authuser=1&user=SD3Nv10AAAAJ"><i class="fas fa-fw fa-graduation-cap"></i> Google Scholar</a></li>
      
      
      
        <li><a href="http://orcid.org/0000-0001-6158-7632"><i class="ai ai-orcid-square ai-fw"></i> ORCID</a></li>
      
      
      
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    
      <meta itemprop="headline" content="ChemScraper: Leveraging PDF Graphics Instructions for Molecular Diagram Parsing">
    
    
      <meta itemprop="description" content="This paper is about a new parser for molecular diagrams.">
    
    
      <meta itemprop="datePublished" content="September 01, 2024">
    
    

    <div class="page__inner-wrap">
      
        <header>
          
            <h1 class="page__title" itemprop="headline">ChemScraper: Leveraging PDF Graphics Instructions for Molecular Diagram Parsing
 (2024)</h1>
          
          <p><strong>Venue:</strong> International Journal on Document Analysis and Recognition (IJDAR) </p>
          <p> <strong>Status:</strong>  Published </p>

          
            <p><strong>Recommended Citation:</strong> A. K. Shah, B. M. Amador, A. Dey, M. Creekmore, B. Ocampo, S. Denmark, and R. Zanibbi, “ChemScraper: Leveraging PDF Graphics Instructions for Molecular Diagram Parsing,” in Document Analysis and Recognition (Journal) - IJDAR 2024, vol. 27, Sep. 2024, pp. 395-414, doi: 10.1007/s10032-024-00486-7.</p>
          

          <div class="publication-links">
            
              <a href="https://link.springer.com/article/10.1007/s10032-024-00486-7" class="btn btn-paper" target="_blank">Publisher PDF</a>
            
            
              <a href="/files/ChemScraper-IJDAR-2024.pdf" class="btn btn-pdf" target="_blank">Preprint PDF</a>
            
            
              <a href="/files/ICDAR2024.pdf" class="btn btn-poster" target="_blank">View Poster</a>
            
            
            
              <a href="https://gitlab.com/dprl/graphics-extraction/-/tree/icdar2024" class="btn btn-code" target="_blank">View Code</a>
            
            
              <a href="https://chemscraper.platform.moleculemaker.org/configuration" class="btn btn-demo" target="_blank">Live Demo</a>
            
          </div>
        </header>
      

      <section class="page__content" itemprop="text">
        <h2 id="abstract">Abstract:</h2>
<p>Most molecular diagram parsers recover chemical structure from raster images
(e.g., PNGs). However, many PDFs include commands giving explicit locations and
shapes for characters, lines, and polygons. We present a new parser that uses
these born-digital PDF primitives as input. The parsing model is fast and
accurate, and does not require GPUs, Optical Character Recognition (OCR), or
vectorization. We use the parser to annotate raster images and then train a new
multi-task neural network for recognizing molecules in raster images. We
evaluate our parsers using SMILES and standard benchmarks, along with a novel
evaluation protocol comparing molecular graphs directly that supports automatic
error compilation and reveals errors missed by SMILES-based evaluation. On the
synthetic USPTO benchmark, our born-digital parser obtains a recognition rate of
98.4% (1% higher than previous models) and our relatively simple neural parser
for raster images obtains a rate of 85% using less training data than existing
neural approaches (thousands vs. millions of molecules).</p>

<iframe src="/files/ICDAR2024.pdf" width="100%" height="600" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>

<p><br /></p>

<iframe src="/files/ChemScraper-IJDAR-2024.pdf" width="100%" height="800" frameborder="no" border="0" marginwidth="0" marginheight="0"></iframe>

<p><br />
<strong>.bib:</strong></p>

<div class="language-bib highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">@article</span><span class="p">{</span><span class="nl">shahChemScraper2024</span><span class="p">,</span>
	<span class="na">abstract</span> <span class="p">=</span> <span class="s">{Most molecular diagram parsers recover chemical structure from raster images (e.g., PNGs). However, many PDFs include commands giving explicit locations and shapes for characters, lines, and polygons. We present a new parser that uses these born-digital PDF primitives as input. The parsing model is fast and accurate, and does not require GPUs, Optical Character Recognition (OCR), or vectorization. We use the parser to annotate raster images and then train a new multi-task neural network for recognizing molecules in raster images. We evaluate our parsers using SMILES and standard benchmarks, along with a novel evaluation protocol comparing molecular graphs directly that supports automatic error compilation and reveals errors missed by SMILES-based evaluation. On the synthetic USPTO benchmark, our born-digital parser obtains a recognition rate of 98.4{\%} (1{\%} higher than previous models) and our relatively simple neural parser for raster images obtains a rate of 85{\%} using less training data than existing neural approaches (thousands vs. millions of molecules).}</span><span class="p">,</span>
	<span class="na">author</span> <span class="p">=</span> <span class="s">{Shah, Ayush Kumar and Amador, Bryan and Dey, Abhisek and Creekmore, Ming and Ocampo, Blake and Denmark, Scott and Zanibbi, Richard}</span><span class="p">,</span>
	<span class="na">date</span> <span class="p">=</span> <span class="s">{2024/09/01}</span><span class="p">,</span>
	<span class="na">date-added</span> <span class="p">=</span> <span class="s">{2024-09-16 13:05:39 -0400}</span><span class="p">,</span>
	<span class="na">date-modified</span> <span class="p">=</span> <span class="s">{2024-09-16 13:05:39 -0400}</span><span class="p">,</span>
	<span class="na">doi</span> <span class="p">=</span> <span class="s">{10.1007/s10032-024-00486-7}</span><span class="p">,</span>
	<span class="na">id</span> <span class="p">=</span> <span class="s">{Shah2024}</span><span class="p">,</span>
	<span class="na">isbn</span> <span class="p">=</span> <span class="s">{1433-2825}</span><span class="p">,</span>
	<span class="na">journal</span> <span class="p">=</span> <span class="s">{International Journal on Document Analysis and Recognition (IJDAR)}</span><span class="p">,</span>
	<span class="na">number</span> <span class="p">=</span> <span class="s">{3}</span><span class="p">,</span>
	<span class="na">pages</span> <span class="p">=</span> <span class="s">{395--414}</span><span class="p">,</span>
	<span class="na">title</span> <span class="p">=</span> <span class="s">{ChemScraper: leveraging PDF graphics instructions for molecular diagram parsing}</span><span class="p">,</span>
	<span class="na">url</span> <span class="p">=</span> <span class="s">{https://doi.org/10.1007/s10032-024-00486-7}</span><span class="p">,</span>
	<span class="na">volume</span> <span class="p">=</span> <span class="s">{27}</span><span class="p">,</span>
	<span class="na">year</span> <span class="p">=</span> <span class="s">{2024}</span><span class="p">,</span>
	<span class="na">bdsk-url-1</span> <span class="p">=</span> <span class="s">{https://doi.org/10.1007/s10032-024-00486-7}</span><span class="p">}</span>
</code></pre></div></div>

<!-- 


<div class="video-holder" style="padding-bottom: 58.03571428571429%">
  <iframe width="560" 
          height="325" 
          src="/files/P1.17-teaser.mov" 
          frameborder="0"
          scrolling="no"
          allowfullscreen></iframe>
</div>
 -->

      </section>
    </div>
  </article>
</div>

<style>
  .publication-links {
    display: flex;
    gap: 10px;
    margin-top: 10px;
  }
  .btn {
    display: inline-block;
    padding: 10px 15px;
    text-decoration: none !important;
    border-radius: 5px;
    font-weight: bold;
    color: white;
    transition: background 0.3s ease, transform 0.2s ease;
  }
  .btn:hover {
    transform: scale(1.05);
  }
  .btn-paper { background-color: #3498db; }
  .btn-pdf { background-color: #555555; }
  .btn-poster { background-color: #9b59b6; }
  .btn-video { background-color: #e74c3c; }
  .btn-code { background-color: #fc6d26; }
  .btn-demo { background-color: #2ecc71; }
</style>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->
<a href="/sitemap/">Sitemap</a>
<!-- end custom footer snippets -->

        

<div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/ayushkumarshah"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="http://localhost:4001/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Ayush Kumar Shah. </div>

      </footer>
    </div>

    <script src="http://localhost:4001/assets/js/main.min.js"></script>




  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>






  
  <script type="text/javascript">
  	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  	var disqus_shortname = 'ayushkumarshah';

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function() {
  		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  	})();

  	/* * * DON'T EDIT BELOW THIS LINE * * */
  	(function () {
  		var s = document.createElement('script'); s.async = true;
  		s.type = 'text/javascript';
  		s.src = '//' + disqus_shortname + '.disqus.com/count.js';
  		(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
  	}());
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>






  </body>
</html>

